package unioeste.geral.endereco.dao;

import java.sql.ResultSet;

import unioeste.apoio.infraestrutura.ConexaoBD;
import unioeste.geral.endereco.Bairro;
import unioeste.geral.endereco.Cidade;
import unioeste.geral.endereco.Endereco;
import unioeste.geral.endereco.Logradouro;
import unioeste.geral.endereco.UnidadeFederativa;
import unioeste.geral.endereco.infra.GlobalApp;

public class UCObterEnderecoPorID {
	
	public UCObterEnderecoPorID(){
		
	}
	
	//Entrada: Objeto Endereco com ID preenchido.
	//Saida: Objeto endereco recuperado do BD a partir do ID.
	public Endereco recuperaEnderecoPorID(Endereco end) throws Exception{
		
		ConexaoBD conexaoBD = GlobalApp.getConexaoBD();
		
		ResultSet result = conexaoBD.execSelect("SELECT * FROM ENDERECO WHERE id_endereco = " + end.getEnderecoID());
		
		
		if (result.next()) {
			  UnidadeFederativa uf = new UnidadeFederativa();
			  Cidade cidade = new Cidade();
			  Bairro bairro = new Bairro();
			  Logradouro log = new Logradouro();
			  
			  end.setCEP(result.getString("cep"));
			  bairro.setNome(result.getString("nome_bairro"));
			  cidade.setNome(result.getString("nome_cidade"));
			  uf.setNome(result.getString("nome_uf"));
			  uf.setSigla(result.getString("sigla_uf"));
			  cidade.setEstado(uf);
			  
			  end.setBairro(bairro.getNome());
			  end.setLogradouro(log.getNome());
			  end.setCidade(cidade.getNome());
		}
			result.close();
		
		if (end.getCEP() == null) {
			throw new Exception ("Endereco n√£o existe");
		}
		
		return end;

	}
	
}
	
